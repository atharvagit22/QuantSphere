import{k as A,r as b,j as a}from"./index-BQwJztVw.js";import{B as f,L as C}from"./index-BGRuDrHz.js";function E(){const{data:l}=A(),i=((l==null?void 0:l.equityData)||[]).map(s=>s.equity??null).filter(s=>s!==null),x=((l==null?void 0:l.equityData)||[]).map(s=>s.date),e=b.useMemo(()=>{const s=[];for(let t=1;t<i.length;t++){const n=i[t-1],r=i[t];n&&r&&s.push((r-n)/Math.max(1,n))}return s},[i]),g=e.reduce((s,t)=>s+t,0)/Math.max(1,e.length),h=Math.sqrt(e.reduce((s,t)=>s+(t-g)**2,0)/Math.max(1,e.length)),u=Math.sqrt(252),N=h*u,y=h===0?0:g*u/h,c=[...e].sort((s,t)=>s-t),m=Math.max(0,Math.floor(c.length*.01)),p=c.length?c[m]:0,M=c.slice(0,m+1).length?c.slice(0,m+1).reduce((s,t)=>s+t,0)/(m+1):p,w=Math.round((p||0)*(i[i.length-1]||0)*-1),R=Math.round((M||0)*(i[i.length-1]||0)*-1),v=l!=null&&l.drawdownData&&l.drawdownData.length?l.drawdownData:x.map(s=>({date:s,value:0})),D={labels:x.slice(1),datasets:[{label:"Abs returns",data:e.map(s=>Math.abs(s)),borderColor:"#06b6d4",pointRadius:0},{label:"Volatility band (30)",data:(()=>{const s=[];for(let t=0;t<e.length;t++){const n=e.slice(Math.max(0,t-29),t+1);if(n.length<2)s.push(0);else{const r=n.reduce((o,d)=>o+d,0)/n.length;s.push(Math.sqrt(n.reduce((o,d)=>o+(d-r)**2,0)/n.length))}}return s})(),borderColor:"#a78bfa",pointRadius:0}]},k={labels:v.map(s=>s.date),datasets:[{label:"Drawdown",data:v.map(s=>s.value),backgroundColor:"rgba(239,68,68,0.7)"}]},j=b.useMemo(()=>{const s=Array(30).fill(0);if(!e.length)return s;const t=Math.min(...e),r=(Math.max(...e)-t)/s.length||1;return e.forEach(o=>{const d=Math.min(s.length-1,Math.floor((o-t)/r));s[d]+=1}),s},[e]),q={labels:j.map((s,t)=>t+1),datasets:[{data:j,backgroundColor:"#fb7185"}]};return a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Risk Metrics"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400",children:"Volatility (annualized)"}),a.jsxs("div",{className:"text-2xl font-semibold mt-2",children:[(N*100).toFixed(2),"%"]})]}),a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400",children:"Sharpe Ratio"}),a.jsx("div",{className:"text-2xl font-semibold mt-2",children:y.toFixed(2)})]}),a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400",children:"Value-at-Risk (99%)"}),a.jsxs("div",{className:"text-2xl font-semibold mt-2",children:["$",w.toLocaleString()]}),a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["CVaR (99%): $",R.toLocaleString()]})]})]}),a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Max Drawdown Timeline"}),a.jsx("div",{className:"h-56",children:a.jsx(f,{data:k,options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}}}})})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Volatility (recent)"}),a.jsx("div",{className:"h-48",children:a.jsx(C,{data:D,options:{maintainAspectRatio:!1}})})]}),a.jsxs("div",{className:"glass-card p-4",children:[a.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Returns Histogram"}),a.jsx("div",{className:"h-48",children:a.jsx(f,{data:q,options:{maintainAspectRatio:!1,plugins:{legend:{display:!1}}}})})]})]})]})}export{E as default};
