import{k as q,r as t,s as g,m as I,n as P,o as k,j as e}from"./index-BQwJztVw.js";import{L as j}from"./index-BGRuDrHz.js";import"./lightweight-charts.production-D4lkRJ8h.js";function T(){const{data:r}=q(),f=Array.isArray(r==null?void 0:r.prices)?r.prices:Array.isArray(r==null?void 0:r.equityData)?r.equityData.map(s=>({date:s.date,close:s.equity})):[],a=f.map(s=>Number(s.close||0)),l=f.map(s=>s.date),N=20,C=50,n=t.useMemo(()=>g(a,N),[a]),c=t.useMemo(()=>g(a,C),[a]),R=20,h=t.useMemo(()=>{const s=g(a,R),d=[],i=[];for(let p=0;p<a.length;p++){const w=Math.max(0,p-R+1),x=a.slice(w,p+1),b=x.reduce((u,y)=>u+y,0)/x.length,A=Math.sqrt(x.reduce((u,y)=>u+(y-b)**2,0)/x.length||0);d.push(b+2*A),i.push(b-2*A)}return{middle:s,upper:d,lower:i}},[a]),v=t.useMemo(()=>I(a,12,26,9),[a]),M=v.macdLine||[],S=v.signalLine||[],m=t.useMemo(()=>P(a,14),[a]),o=t.useMemo(()=>{const s=[];return k(n,c).forEach(i=>{s.push({type:i.type,index:i.index,price:a[i.index],date:l[i.index],rsi:m[i.index]??null})}),s},[n,c,a,l,m]),D=t.useMemo(()=>({labels:l,datasets:[{label:"Price",data:a,borderColor:"#60a5fa",pointRadius:0,tension:.25,fill:!1},{label:`${N} SMA`,data:n,borderColor:"#a78bfa",borderDash:[6,3],pointRadius:0},{label:`${C} SMA`,data:c,borderColor:"#06b6d4",borderDash:[6,3],pointRadius:0},{label:"BB Upper",data:h.upper,borderColor:"#f97316",pointRadius:0,borderDash:[4,2],fill:!1},{label:"BB Lower",data:h.lower,borderColor:"#f97316",pointRadius:0,borderDash:[4,2],fill:!1},{label:"Buy",data:o.filter(s=>s.type==="buy").map(s=>({x:s.date,y:s.price})),type:"scatter",pointStyle:"triangle",pointRadius:8,pointBackgroundColor:"#10b981",showLine:!1,order:10},{label:"Sell",data:o.filter(s=>s.type==="sell").map(s=>({x:s.date,y:s.price})),type:"scatter",pointStyle:"triangle",rotation:180,pointRadius:8,pointBackgroundColor:"#ef4444",showLine:!1,order:10}]}),[l,a,n,c,h,o]),L=t.useMemo(()=>({labels:l,datasets:[{label:"MACD",data:M,borderColor:"#60a5fa",pointRadius:0},{label:"Signal",data:S,borderColor:"#a78bfa",pointRadius:0}]}),[l,M,S]),B=t.useMemo(()=>({labels:l,datasets:[{label:"RSI (14)",data:m,borderColor:"#f59e0b",pointRadius:0}]}),[l,m]);return a.length?e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Signals"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Price signals, Bollinger Bands, MACD and RSI"})]}),e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Price & Indicators"}),e.jsx("div",{className:"h-80",children:e.jsx(j,{data:D,options:{maintainAspectRatio:!1}})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-4 h-48",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"MACD"}),e.jsx(j,{data:L,options:{maintainAspectRatio:!1}})]}),e.jsxs("div",{className:"glass-card p-4 h-48",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"RSI (14)"}),e.jsx(j,{data:B,options:{maintainAspectRatio:!1}})]})]}),e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Recent Trading Signals"}),o.length===0?e.jsx("div",{className:"text-gray-500 italic",children:"No signals found for current dataset."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-gray-400",children:e.jsxs("tr",{className:"border-b border-[#111827]",children:[e.jsx("th",{className:"py-2",children:"Date"}),e.jsx("th",{className:"py-2",children:"Type"}),e.jsx("th",{className:"py-2",children:"Price"}),e.jsx("th",{className:"py-2",children:"RSI"})]})}),e.jsx("tbody",{children:o.slice(-50).reverse().map((s,d)=>e.jsxs("tr",{className:"border-b border-[#111827]",children:[e.jsx("td",{className:"py-2",children:s.date}),e.jsx("td",{className:`py-2 ${s.type==="buy"?"text-green-400":"text-red-400"}`,children:s.type.toUpperCase()}),e.jsx("td",{className:"py-2",children:Number(s.price).toFixed(2)}),e.jsx("td",{className:"py-2",children:s.rsi?s.rsi.toFixed(1):"-"})]},d))})]})]})]}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"glass-card p-4 text-gray-400",children:"No price/equity series available â€” upload CSV or load demo."})})}export{T as default};
